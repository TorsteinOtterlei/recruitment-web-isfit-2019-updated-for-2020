{% extends 'jobs/base.html' %}
{% block title %} {{ application.applicant.get_full_name }} {% endblock %}
{% load static %}

{% block head %}
<style media="screen">
.title {
    text-align: center;
}
.title * {

    display: inline-block;
}
.status-field { /* classname given in StatusForm */
    -webkit-appearance: none;
    -moz-appearance: none;
    border: none;
    background-color: black;
    color: orange;
    outline: none;
    cursor: pointer;
}
.button-back {
    position: absolute;
    top: 80px;
    left: 20px;
}
.collapsing-field {
    background-color: #23272b;
    border: 1px solid #343a40;
    border-top-style: none;
    border-bottom-left-radius: 8px;
    border-bottom-right-radius: 8px;
    padding: 10px;
}
hr {
    border: 1px solid white;
}
</style>
{% endblock %}

{% block body %}
<div class="container">

    <!-- Back button -->
    <a href="{% url 'applications:manage_applications' %}">
        <img id="arrow-left" src="{% static 'applications/arrow_left.png' %}" alt="Arrow left">
        Manage applications
    </a>

    <!-- Title -->
    <div class="title">
        <h1>Applicant: {{ application.applicant.get_full_name }}</h1>
        <form id="statusForm" method="post" action="#">
            {% csrf_token %}
            &emsp;Status: {{ form.status }}
        </form>
    </div>
    <br>
    <!-- Button: Information collapse -->
    <button class="btn btn-dark btn-block" type="button" data-toggle="collapse" data-target="#info-box" aria-expanded="false">
        Applicant information:
    </button>
    <!-- Information-box collapsible -->
    <div class="collapse collapsing-field" id="info-box">
        <p>Email address: {{ application.applicant.email }}</p>
        <p>Phone number: {{ application.applicant.phone_number }}</p>
    </div>
    <br>

    <!-- Button: Application-text collapse -->
    <button class="btn btn-dark btn-block" type="button" data-toggle="collapse" data-target="#application-text-box" aria-expanded="false">
        Application text:
    </button>
    <!-- Application-text collapsible -->
    <div class="collapse collapsing-field" id="application-text-box">
        <p>{{ application.text}}</p>
    </div>
    <br>

    <!-- Button: Applied-positions collapse -->
    <button class="btn btn-dark btn-block" type="button" data-toggle="collapse" data-target="#applied-positions" aria-expanded="false">
        Positions and interviewers:
    </button>
    <!-- Application-text collapsible -->
    <div class="collapse collapsing-field" id="applied-positions">
        {% for position in application.get_positions %}
            <p>{{ forloop.counter }}. {{ position }},&emsp; Interviewer: {{ position.interviewer }}</p>
            <hr>
        {% endfor %}
    </div>

    <br><br><br>


    <p>{{ application.applicant.get_short_name }}'s available dates:<br>{{ application.applicant.date.dates_list }}</p>
    <br />
    <br />

    {% comment %}
    Compatible times for interviews:
    {% for i in application.applicant.date.dates_list %}
    {% for j in application.first.interviewer.date.dates_list %}
    {% for k in application.second.interviewer.date.dates_list %}
    {% if i == j and j == k %}
    {{ i }},
    {% endif %}
    {% endfor %}
    {% endfor %}
    {% endfor %}
    {% endcomment %}

</div>
{% endblock body %}

{% block scriptblock %}
<script type="text/javascript">
    $(document).ready(function() {
        $("#statusForm").change(function() {
            $("#statusForm").submit()
        }) // End: statusForm.change

        // Create divs inside grid. Easier than adding them manually
        for (var i=0; i<91; i++) { // 70 because of temporary 0-69 grid
            var div = document.createElement("div");  // Create with DOM
            div.id = i; // Give each cell their id according to grid
            div.className = "gridcell";
            $(".grid1").append(div);
        } // End: cell-appending to grid

        // Display previously selected dates
        for (var i = 0; i < user_dates.length; i++) {
            var cellid = "#" + user_dates[i];
            $(cellid).html(filler);
        } // End: Display previously selected dates
    }) // End: document.ready
</script>
{% endblock %}
